# 1 SRE 面试

### 1 Linux 如何查看和杀死进程

```
ps -aux 
ps -ef

# pid 父进程pid, 进程启动时间， 谁启动这个进程

top  #实时信息

kill / kill -9
```

### 2 硬链接and软连接

* ***硬链接 是同一个文件不同的访问入口** 所有的链接都共享一个**inode 和同一个数据块**


* 软连接更像一个文件的快捷访问，存储源文件的绝对路径，一旦源文件删掉，软连接就失效



### 3 常用的Linux 文件系统类型

主要有两个

- 1 EXT4 最大支持1EB的文件系统，16TB的文件大小， **特点是延迟分配，有数据写入才会分配一块空间**
- 2 XFS **高性能文件系统，能够处理非常高并发的镀锡操作**


### 4 Linux中配置程序开机自启动

**1 rc.local 文件里面加入 脚本启动的命令** 开机过程中，系统会默认加载这个系统

**2 把脚本做出系统服务， 创建一个service 文件，把启动脚本的一些命令写进去**

Systeml enable 来设置它的开机自启动

### 5 CPU 突然飙升

1. Top 所有进程的详细情况，找到CPU占用率高的进程，进入进程所在的目录
2. 查看日志 结合 strce -p pid /  perf top -p pid
3. 第三方程序， kill

### 6 网站访问慢

1. 网络资源  ping 外网
2. 服务器硬件资源 top
3. 软件本身 日志查看
4. 数据块查询慢 数据块性能查询工具


### 7 Nginx 负载模式

轮询 / 加权轮询 / ip hash / 最少链接 / 加权最少链接

### 8 keepalived 工作原理

VRRP 协议选举出来一个master 主节点和多个backup节点

**主节点负责流量分配** 同时给下面的backup节点发送vrrp 协议加密通告信息

当backup节点搜不到通告信息，就认为mater 节点不可用， 优先级最高的backup 节点就会成为新的master


### 9 LVS vs Nginx vs Haproxy

LVS: 四层转发， url 不可转发

Haproxy 七层转发 专业代理服务器

Nginx web 服务器 ，支持 4+7层转发

### 10 提高Mysql的安全性

1. **修改mysql默认端口，不使用3306**
2. **设置访问ip白名单，单台服务器只允许127访问**
3. 设置mysql root用户为强密码，且只允许通过本地连接

4. 为应用数据库设置独立的链接账号，且以最小权限原则进行权限配置，仅允许操作自己应用相关的数据

5. **在服务程序的配置文件中不允许使用明文配置 mysql 密码，（我们一般用aes 算法 配置文件里面存密文）**

6. 关注 数据库相关cve漏洞信息，对出现的安全问题进行及时处理。

7. 若数据库链接需要通过网络传输，则需要配置 ssl 加密传输


### 11 栈内存和堆内存的区别

栈内存存储比较小的东西，like调入一个函数，把函数的参数信息放在栈内存，当函数调用结束，栈内存会被释放掉

递归函数一直被调用，会导致栈内存的溢出， 

堆内存存储一般比较大的的数据，或者不确定大小的数据。新建一个对象用来存储数据的链表


### 12 RAID 是什么

**存储虚拟化的技术**，多个物理磁盘组合在一起，形成一个逻辑上存储单元，存储量变大，安全性提高

**RAID0 把数据分散到不同的硬盘中，提高性能，但是安全性不高** 某一块坏了，数据丢失

 
**RAID1 数据完整的在复制一份，存下来，对于大的逻辑硬盘每个数据是存了两份**  利用率50%

**RAID5 奇偶校验和数据信息， 都会会存在多个硬盘当中**，一块坏了，也能根据奇偶校验信息恢复

### 13 du vs df


Du 查看文件和目录的磁盘使用情况。 便利一个目录地下所有的文件。 计算统计这些东西，所有加在一起，占了多少空间

**Df 显示文件系统所有的总空间， 已经使用的空间和剩余的空间。 基于文件系统的元数据， 来计算磁盘空间的。**

**当文件有多个硬链接，du会计算很多次，df 只计算一次**

**文件被删除， du 判断这个文件不存在了， 空间不会被计算**  df 整个系统层面来计算，它认为这个空间被占用了


### 14 进程优先级

静态的 设置优先级 nice 

正在运行的renice -n nice -p pid 

### 15 Mysql主从

数据同步方式 

Master 记录所有的操作方式，保存在binlog 日志里面，一个二进制的文件

创建一个线程，会把二进制文件传给slave. Slave 读取二进制文件。把信息记录下来，保证了master节点和slave 节点信息的一致


### 16 PDO pending 的原因

1. 硬件资源不足
2. 镜像获取失败
3. 网络插件的原因，网络无法链接
4. pod需要绑定一个PVC， 但是现在没有可用的。Pod创建的请求，scheduler 没有来得及去处理它，没有找到合适资源和node


### 17 shell的三剑客

**1 grep -> 搜索**

```
grep “error” app.log
```


**2 sed -> 加载数据和删除，替换**

```
# A替换成B
sed -i 's/A/B/g' app.txt

# 把C删除
sed -i /s/C//g' app.txt
```

**2 awk -> 把文件按行的形式全部读取出来**

* 默认空格进行切边
* -F 参数指定一个分隔符
	* if 判断
    * begin end
  

### 18 top 展示那些信息

Top 展示系统的是实体信息

1. 时间，用户，负载
2. 进程
3. CPU
4. 内存
5. 交换区
6. 具体进程的状态 （优先级， PID)


### 19 proc 目录

虚拟文件系统，存储系统当时运行的一个状态

### 20 pod的状态

Pending  running succeeded Failed Unknown

### 21 pod如何通信

1.不同的pod同一个节点中

- 通过Node节点的本地网络进行通信
- pod的IP地址进行通信

1.不同的pod在不同的节点（Naode)

- pod的IP地址进行通信
- 通过service 通信
- 跨节点的网络插件
- k8s集群中忧有一个**路由表**

### 21 Scheduler 调度流程

Scheduler 持续监听API server 的实物状态

一旦有一个被调度的pod或者正在运行的pod需要被调度

1. 筛选Node,筛选Node, 零容忍，存储等下新 =》 筛选集
2. 根据策略匹配Node，确定node节点之后。pod信息和Node节点进行绑定写入Etcd中
3. 





































